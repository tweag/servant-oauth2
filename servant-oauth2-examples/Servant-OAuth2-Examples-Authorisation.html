<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Servant.OAuth2.Examples.Authorisation</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">servant-oauth2-examples-0.1.0.1: Example applications using this library in three ways.</span><ul class="links" id="page-menu"><li><a href="src/Servant.OAuth2.Examples.Authorisation.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Servant.OAuth2.Examples.Authorisation</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This is the last example we provide, but also the most interesting, and,
indeed, the main motivation for this libraries existence!</p><p>Here we show how to build type-level authorisation into your Servant API,
backed by authentication with OAuth2.</p><p>We assume you've read over the previous two examples, as we build directly
on that knowledge:</p><ul><li><a href="Servant-OAuth2-Examples-Simple.html">Servant.OAuth2.Examples.Simple</a></li><li><a href="Servant-OAuth2-Examples-Cookies.html">Servant.OAuth2.Examples.Cookies</a></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:Db">Db</a> = HashMap <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Role">Role</a><ul class="subs"><li>= <a href="#v:Anyone">Anyone</a></li><li>| <a href="#v:Admin">Admin</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:User">User</a> = <a href="#v:User">User</a> {<ul class="subs"><li><a href="#v:email">email</a> :: <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li><a href="#v:role">role</a> :: <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:Env">Env</a> (r :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Role" title="Servant.OAuth2.Examples.Authorisation">Role</a>) = <a href="#v:Env">Env</a> {<ul class="subs"><li><a href="#v:user">user</a> :: <a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a></li><li><a href="#v:githubSettings">githubSettings</a> :: <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Github <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a></li><li><a href="#v:githubOAuthConfig">githubOAuthConfig</a> :: <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a></li><li><a href="#v:googleSettings">googleSettings</a> :: <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Google <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a></li><li><a href="#v:googleOAuthConfig">googleOAuthConfig</a> :: <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:PageM">PageM</a> = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Env" title="Servant.OAuth2.Examples.Authorisation">Env</a> '<a href="Servant-OAuth2-Examples-Authorisation.html#v:Anyone" title="Servant.OAuth2.Examples.Authorisation">Anyone</a>) Handler</li><li class="src short"><span class="keyword">type</span> <a href="#t:AdminPageM">AdminPageM</a> = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Env" title="Servant.OAuth2.Examples.Authorisation">Env</a> '<a href="Servant-OAuth2-Examples-Authorisation.html#v:Admin" title="Servant.OAuth2.Examples.Authorisation">Admin</a>) Handler</li><li class="src short"><span class="keyword">type</span> <a href="#t:OAuth2Result">OAuth2Result</a> = '[WithStatus 303 <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2-Cookies.html#t:RedirectWithCookie" title="Servant.OAuth2.Cookies">RedirectWithCookie</a>]</li><li class="src short"><a href="#v:optionalUserAuthHandler">optionalUserAuthHandler</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Db" title="Servant.OAuth2.Examples.Authorisation">Db</a> -&gt; Key -&gt; AuthHandler Request (<a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Routes">Routes</a> mode = <a href="#v:Routes">Routes</a> {<ul class="subs"><li><a href="#v:site">site</a> :: mode :- (AuthProtect &quot;optional-cookie&quot; :&gt; NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a>)</li><li><a href="#v:authGithub">authGithub</a> :: mode :- (AuthProtect Github :&gt; (&quot;auth&quot; :&gt; (&quot;github&quot; :&gt; NamedRoutes (<a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Routes" title="Servant.OAuth2">OAuth2Routes</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a>))))</li><li><a href="#v:authGoogle">authGoogle</a> :: mode :- (AuthProtect Google :&gt; (&quot;auth&quot; :&gt; (&quot;google&quot; :&gt; NamedRoutes (<a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Routes" title="Servant.OAuth2">OAuth2Routes</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a>))))</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:SiteRoutes">SiteRoutes</a> mode = <a href="#v:SiteRoutes">SiteRoutes</a> {<ul class="subs"><li><a href="#v:home">home</a> :: mode :- Get '[HTML] Html</li><li><a href="#v:admin">admin</a> :: mode :- (&quot;admin&quot; :&gt; NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>)</li><li><a href="#v:logout">logout</a> :: mode :- (&quot;logout&quot; :&gt; UVerb 'GET '[HTML] '[WithStatus 303 <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2-Cookies.html#t:RedirectWithCookie" title="Servant.OAuth2.Cookies">RedirectWithCookie</a>])</li></ul>}</li><li class="src short"><a href="#v:siteServer">siteServer</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> (AsServerT <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:AdminRoutes">AdminRoutes</a> mode = <a href="#v:AdminRoutes">AdminRoutes</a> {<ul class="subs"><li><a href="#v:adminHome">adminHome</a> :: mode :- Get '[HTML] Html</li></ul>}</li><li class="src short"><a href="#v:adminHandler">adminHandler</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a> Html</li><li class="src short"><a href="#v:verifyAdmin">verifyAdmin</a> :: ServerT (NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>) <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a> -&gt; ServerT (NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>) <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></li><li class="src short"><a href="#v:adminServer">adminServer</a> :: ServerT (NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>) <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></li><li class="src short"><a href="#v:isAdmin">isAdmin</a> :: <a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a> -&gt; <a href="../base-4.15.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:isLoggedIn">isLoggedIn</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> <a href="../base-4.15.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:getUser">getUser</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> (<a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a>)</li><li class="src short"><a href="#v:getAdmin">getAdmin</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a></li><li class="src short"><a href="#v:homeHandler">homeHandler</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Html</li><li class="src short"><a href="#v:server">server</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> (AsServerT <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a>)</li><li class="src short"><a href="#v:mkGithubSettings">mkGithubSettings</a> :: Key -&gt; <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a> -&gt; <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Github <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a></li><li class="src short"><a href="#v:mkGoogleSettings">mkGoogleSettings</a> :: Key -&gt; <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a> -&gt; <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Google <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a></li><li class="src short"><a href="#v:main">main</a> :: <a href="../base-4.15.1.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:loadDb">loadDb</a> :: <a href="../base-4.15.1.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:Db" title="Servant.OAuth2.Examples.Authorisation">Db</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Db" class="def">Db</a> = HashMap <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#Db" class="link">Source</a> <a href="#t:Db" class="selflink">#</a></p><div class="doc"><p>This time we're going to have users. We're keeping it light and easy
 here, so our <em>database</em> is simply a map of emails to users. At this point
 I'd like to note a slight quirk of oauth2-based authentication.</p><p>Note that the ident that comes back from the provider is up to that
 provider itself. So, for example, I could make an entirely new oauth2
 provider that always returns the same email, for example. In particular, it
 could always return _you_ email. Then, if this website added my (dodgey)
 provider to it's list, I would be able to log in as you, if all you to do
 verify accounts is <em>look up the user by the email</em>. So, in any real system,
 you should track the <em>provider name</em> along side the user ident, and only
 use <em>that</em> combination to find users. We don't do that here, but it's worth
 remembering.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Role" class="def">Role</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#Role" class="link">Source</a> <a href="#t:Role" class="selflink">#</a></p><div class="doc"><p>We will use this type to tag particular routes as being only accessible
 to users with the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:Admin" title="Servant.OAuth2.Examples.Authorisation">Admin</a></code> role, or, alternatively, <em>everyone</em>, i.e. those
 people having the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:Anyone" title="Servant.OAuth2.Examples.Authorisation">Anyone</a></code> role ... namely, everyone!</p><p><em>Since: 0.1.0.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Anyone" class="def">Anyone</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Admin" class="def">Admin</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:User" class="def">User</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#User" class="link">Source</a> <a href="#t:User" class="selflink">#</a></p><div class="doc"><p>Our user type that lives in the database. Importantly, this holds the
 <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:role" title="Servant.OAuth2.Examples.Authorisation">role</a></code>, which we will check when it comes to verifying if a particular
 person can access the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:Admin" title="Servant.OAuth2.Examples.Authorisation">Admin</a></code> route.</p><p><em>Since: 0.1.0.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:User" class="def">User</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:email" class="def">email</a> :: <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:role" class="def">role</a> :: <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:User">Instances</h4><details id="i:User" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:User:Show:1"></span> <a href="../base-4.15.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a></span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-115" class="link">Source</a> <a href="#t:User" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:User:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.15.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a> -&gt; <a href="../base-4.15.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a> -&gt; <a href="../base-4.15.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a>] -&gt; <a href="../base-4.15.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Env" class="def">Env</a> (r :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Role" title="Servant.OAuth2.Examples.Authorisation">Role</a>) <a href="src/Servant.OAuth2.Examples.Authorisation.html#Env" class="link">Source</a> <a href="#t:Env" class="selflink">#</a></p><div class="doc"><p>This is a collection of data that we'll want to have available during
 page processing; so we will wrap the servant <code>Handler</code> type with a
 <code><a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a></code> over this type.</p><p><em>Since: 0.1.0.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Env" class="def">Env</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:user" class="def">user</a> :: <a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:githubSettings" class="def">githubSettings</a> :: <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Github <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:githubOAuthConfig" class="def">githubOAuthConfig</a> :: <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:googleSettings" class="def">googleSettings</a> :: <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Google <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:googleOAuthConfig" class="def">googleOAuthConfig</a> :: <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:PageM" class="def">PageM</a> = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Env" title="Servant.OAuth2.Examples.Authorisation">Env</a> '<a href="Servant-OAuth2-Examples-Authorisation.html#v:Anyone" title="Servant.OAuth2.Examples.Authorisation">Anyone</a>) Handler <a href="src/Servant.OAuth2.Examples.Authorisation.html#PageM" class="link">Source</a> <a href="#t:PageM" class="selflink">#</a></p><div class="doc"><p>Our type-level authorisation system. We tag two kinds of <em>page monads</em>;
 one that works for <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:Anyone" title="Servant.OAuth2.Examples.Authorisation">Anyone</a></code>; this one.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:AdminPageM" class="def">AdminPageM</a> = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Env" title="Servant.OAuth2.Examples.Authorisation">Env</a> '<a href="Servant-OAuth2-Examples-Authorisation.html#v:Admin" title="Servant.OAuth2.Examples.Authorisation">Admin</a>) Handler <a href="src/Servant.OAuth2.Examples.Authorisation.html#AdminPageM" class="link">Source</a> <a href="#t:AdminPageM" class="selflink">#</a></p><div class="doc"><p>And this one, that is specialised to <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:Admin" title="Servant.OAuth2.Examples.Authorisation">Admin</a></code> users. If we make a mistake,
 we will get a type error along the lines of <code>Cannot match 'Admin with
 'Anyone</code>.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:OAuth2Result" class="def">OAuth2Result</a> = '[WithStatus 303 <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2-Cookies.html#t:RedirectWithCookie" title="Servant.OAuth2.Cookies">RedirectWithCookie</a>] <a href="src/Servant.OAuth2.Examples.Authorisation.html#OAuth2Result" class="link">Source</a> <a href="#t:OAuth2Result" class="selflink">#</a></p><div class="doc"><p>As in the <a href="Servant-OAuth2-Examples-Cookies.html">Servant.OAuth2.Examples.Cookies</a> example, our result type is
 just a redirection with a cookie.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:optionalUserAuthHandler" class="def">optionalUserAuthHandler</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Db" title="Servant.OAuth2.Examples.Authorisation">Db</a> -&gt; Key -&gt; AuthHandler Request (<a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a>) <a href="src/Servant.OAuth2.Examples.Authorisation.html#optionalUserAuthHandler" class="link">Source</a> <a href="#v:optionalUserAuthHandler" class="selflink">#</a></p><div class="doc"><p>This is almost identical to the <a href="Servant-OAuth2-Examples-Cookies.html">Servant.OAuth2.Examples.Cookies</a>
 example, except we look up the user in the database, and if we find it, we
 return it.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Routes" class="def">Routes</a> mode <a href="src/Servant.OAuth2.Examples.Authorisation.html#Routes" class="link">Source</a> <a href="#t:Routes" class="selflink">#</a></p><div class="doc"><p>This follows exactly the <a href="Servant-OAuth2-Examples-Cookies.html">Servant.OAuth2.Examples.Cookies</a> example; we're
 using two providers because in the hard-coded `db.txt` file I've set
 different roles for my own account with different providers; you'll be able
 to edit that file to do the same.</p><p><em>Since: 0.1.0.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Routes" class="def">Routes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:site" class="def">site</a> :: mode :- (AuthProtect &quot;optional-cookie&quot; :&gt; NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:authGithub" class="def">authGithub</a> :: mode :- (AuthProtect Github :&gt; (&quot;auth&quot; :&gt; (&quot;github&quot; :&gt; NamedRoutes (<a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Routes" title="Servant.OAuth2">OAuth2Routes</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a>))))</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:authGoogle" class="def">authGoogle</a> :: mode :- (AuthProtect Google :&gt; (&quot;auth&quot; :&gt; (&quot;google&quot; :&gt; NamedRoutes (<a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Routes" title="Servant.OAuth2">OAuth2Routes</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a>))))</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Routes">Instances</h4><details id="i:Routes" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Routes:Generic:1"></span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode)</span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-209" class="link">Source</a> <a href="#t:Routes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Routes:Generic:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode) :: <a href="../base-4.15.1.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.15.1.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode -&gt; <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode) x -&gt; <a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Routes:Rep:2"></span> <span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode)</span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-209" class="link">Source</a> <a href="#t:Routes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Routes:Rep:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="src"><span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> mode) = <a href="../base-4.15.1.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;Routes&quot; &quot;Servant.OAuth2.Examples.Authorisation&quot; &quot;servant-oauth2-examples-0.1.0.1-EmzJtQfsyJPG4cNzNv1mEY&quot; '<a href="../base-4.15.1.0/Data-Bool.html#v:False" title="Data.Bool">False</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;Routes&quot; '<a href="../base-4.15.1.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> '<a href="../base-4.15.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;site&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- (AuthProtect &quot;optional-cookie&quot; :&gt; NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a>))) <a href="../base-4.15.1.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> (<a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;authGithub&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- (AuthProtect Github :&gt; (&quot;auth&quot; :&gt; (&quot;github&quot; :&gt; NamedRoutes (<a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Routes" title="Servant.OAuth2">OAuth2Routes</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a>)))))) <a href="../base-4.15.1.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> <a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;authGoogle&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- (AuthProtect Google :&gt; (&quot;auth&quot; :&gt; (&quot;google&quot; :&gt; NamedRoutes (<a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Routes" title="Servant.OAuth2">OAuth2Routes</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a>)))))))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SiteRoutes" class="def">SiteRoutes</a> mode <a href="src/Servant.OAuth2.Examples.Authorisation.html#SiteRoutes" class="link">Source</a> <a href="#t:SiteRoutes" class="selflink">#</a></p><div class="doc"><p>We now have a slightly more complicated route setup; we need our
 homepage, and our admin area, which we will aim to protect with our
 type-level tags; we also need a <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:logout" title="Servant.OAuth2.Examples.Authorisation">logout</a></code> route, because it'll be convenient
 for testing. This route will simply delete the present cookie.</p><p><em>Since: 0.1.0.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SiteRoutes" class="def">SiteRoutes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:home" class="def">home</a> :: mode :- Get '[HTML] Html</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:admin" class="def">admin</a> :: mode :- (&quot;admin&quot; :&gt; NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:logout" class="def">logout</a> :: mode :- (&quot;logout&quot; :&gt; UVerb 'GET '[HTML] '[WithStatus 303 <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2-Cookies.html#t:RedirectWithCookie" title="Servant.OAuth2.Cookies">RedirectWithCookie</a>])</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SiteRoutes">Instances</h4><details id="i:SiteRoutes" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SiteRoutes:Generic:1"></span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode)</span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-223" class="link">Source</a> <a href="#t:SiteRoutes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SiteRoutes:Generic:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode) :: <a href="../base-4.15.1.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.15.1.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode -&gt; <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode) x -&gt; <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SiteRoutes:Rep:2"></span> <span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode)</span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-223" class="link">Source</a> <a href="#t:SiteRoutes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SiteRoutes:Rep:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="src"><span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> mode) = <a href="../base-4.15.1.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;SiteRoutes&quot; &quot;Servant.OAuth2.Examples.Authorisation&quot; &quot;servant-oauth2-examples-0.1.0.1-EmzJtQfsyJPG4cNzNv1mEY&quot; '<a href="../base-4.15.1.0/Data-Bool.html#v:False" title="Data.Bool">False</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;SiteRoutes&quot; '<a href="../base-4.15.1.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> '<a href="../base-4.15.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;home&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- Get '[HTML] Html)) <a href="../base-4.15.1.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> (<a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;admin&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- (&quot;admin&quot; :&gt; NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>))) <a href="../base-4.15.1.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> <a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;logout&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- (&quot;logout&quot; :&gt; UVerb 'GET '[HTML] '[WithStatus 303 <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2-Cookies.html#t:RedirectWithCookie" title="Servant.OAuth2.Cookies">RedirectWithCookie</a>]))))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:siteServer" class="def">siteServer</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:SiteRoutes" title="Servant.OAuth2.Examples.Authorisation">SiteRoutes</a> (AsServerT <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a>) <a href="src/Servant.OAuth2.Examples.Authorisation.html#siteServer" class="link">Source</a> <a href="#v:siteServer" class="selflink">#</a></p><div class="doc"><p>Nothing too innovative; we just pass off to respective handlers and
 servers; in the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:logout" title="Servant.OAuth2.Examples.Authorisation">logout</a></code> route we set an empty cookie and redirect home.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:AdminRoutes" class="def">AdminRoutes</a> mode <a href="src/Servant.OAuth2.Examples.Authorisation.html#AdminRoutes" class="link">Source</a> <a href="#t:AdminRoutes" class="selflink">#</a></p><div class="doc"><p>Our admin routes. At this point they look normal.</p><p><em>Since: 0.1.0.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AdminRoutes" class="def">AdminRoutes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:adminHome" class="def">adminHome</a> :: mode :- Get '[HTML] Html</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:AdminRoutes">Instances</h4><details id="i:AdminRoutes" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:AdminRoutes:Generic:1"></span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Generic" title="GHC.Generics">Generic</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode)</span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-244" class="link">Source</a> <a href="#t:AdminRoutes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:AdminRoutes:Generic:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode) :: <a href="../base-4.15.1.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../base-4.15.1.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode -&gt; <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode) x -&gt; <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:AdminRoutes:Rep:2"></span> <span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode)</span> <a href="src/Servant.OAuth2.Examples.Authorisation.html#line-244" class="link">Source</a> <a href="#t:AdminRoutes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:AdminRoutes:Rep:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-OAuth2-Examples-Authorisation.html">Servant.OAuth2.Examples.Authorisation</a></p> <div class="src"><span class="keyword">type</span> <a href="../base-4.15.1.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a> mode) = <a href="../base-4.15.1.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;AdminRoutes&quot; &quot;Servant.OAuth2.Examples.Authorisation&quot; &quot;servant-oauth2-examples-0.1.0.1-EmzJtQfsyJPG4cNzNv1mEY&quot; '<a href="../base-4.15.1.0/Data-Bool.html#v:False" title="Data.Bool">False</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;AdminRoutes&quot; '<a href="../base-4.15.1.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> '<a href="../base-4.15.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../base-4.15.1.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../base-4.15.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a> &quot;adminHome&quot;) '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../base-4.15.1.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../base-4.15.1.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> (mode :- Get '[HTML] Html))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:adminHandler" class="def">adminHandler</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a> Html <a href="src/Servant.OAuth2.Examples.Authorisation.html#adminHandler" class="link">Source</a> <a href="#v:adminHandler" class="selflink">#</a></p><div class="doc"><p>Here is where we introduce the <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a></code> type. Typically, a handler
 like this would have type <code>Handler</code>; but here we're denoting it as having
 the <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a></code> type. This means we can call specific functions, that we
 will define below, such as <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:getAdmin" title="Servant.OAuth2.Examples.Authorisation">getAdmin</a></code>. Importantly, we will see that we
 need to unwrap this type (by verifying the current user!) before we can
 render this page.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:verifyAdmin" class="def">verifyAdmin</a> :: ServerT (NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>) <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a> -&gt; ServerT (NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>) <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#verifyAdmin" class="link">Source</a> <a href="#v:verifyAdmin" class="selflink">#</a></p><div class="doc"><p>Here's the most important function. We aim to convert <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a></code>s into
 <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></code>s. We do this in the context of an <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></code> function, where we
 investigate the current user. If that user is an admin (vi a<code><a href="Servant-OAuth2-Examples-Authorisation.html#v:isAdmin" title="Servant.OAuth2.Examples.Authorisation">isAdmin</a></code>) then
 we convert the given <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a></code> into a <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></code> by simply <code><a href="../base-4.15.1.0/Data-Coerce.html#v:coerce" title="Data.Coerce">coerce</a></code>ing it;
 after all, the <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:Role" title="Servant.OAuth2.Examples.Authorisation">Role</a></code> type was just a phantom type.</p><p>If we fail to verify that they are an admin, we throw a http 404 error.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:adminServer" class="def">adminServer</a> :: ServerT (NamedRoutes <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminRoutes" title="Servant.OAuth2.Examples.Authorisation">AdminRoutes</a>) <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#adminServer" class="link">Source</a> <a href="#v:adminServer" class="selflink">#</a></p><div class="doc"><p>Note here that this function returns a server of <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></code>s; that's because
 we pass the routes through the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:verifyAdmin" title="Servant.OAuth2.Examples.Authorisation">verifyAdmin</a></code> function.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:isAdmin" class="def">isAdmin</a> :: <a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a> -&gt; <a href="../base-4.15.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#isAdmin" class="link">Source</a> <a href="#v:isAdmin" class="selflink">#</a></p><div class="doc"><p>A simple check to see if the user is present and has a <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:role" title="Servant.OAuth2.Examples.Authorisation">role</a></code> that is
 equal to `&quot;admin&quot;`.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:isLoggedIn" class="def">isLoggedIn</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> <a href="../base-4.15.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#isLoggedIn" class="link">Source</a> <a href="#v:isLoggedIn" class="selflink">#</a></p><div class="doc"><p>Check if a user is present and therefore logged in.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:getUser" class="def">getUser</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> (<a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a>) <a href="src/Servant.OAuth2.Examples.Authorisation.html#getUser" class="link">Source</a> <a href="#v:getUser" class="selflink">#</a></p><div class="doc"><p>In the context of a <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a></code>, maybe return the user; this is the best we
 can do.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:getAdmin" class="def">getAdmin</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:User" title="Servant.OAuth2.Examples.Authorisation">User</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#getAdmin" class="link">Source</a> <a href="#v:getAdmin" class="selflink">#</a></p><div class="doc"><p>In the present of an <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:AdminPageM" title="Servant.OAuth2.Examples.Authorisation">AdminPageM</a></code>, <em>definitely</em> return a user. We're
 happy with an error if this fails, because we know that a user needs to be
 present.</p><p>Note that it could be an extension to this code to eliminate the <code><a href="../base-4.15.1.0/Data-Maybe.html#v:fromJust" title="Data.Maybe">fromJust</a></code>
 here, and ensure that whatever context we're referencing has eliminated the
 <code><a href="../base-4.15.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a></code> over the user.</p><p>We leave this as an exercise for the reader :)</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:homeHandler" class="def">homeHandler</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Html <a href="src/Servant.OAuth2.Examples.Authorisation.html#homeHandler" class="link">Source</a> <a href="#v:homeHandler" class="selflink">#</a></p><div class="doc"><p>This time our home handler does a bit of busywork to show whether or not
 you're logged in, and provide the relevant links. It also detects if you're
 an admin, and if not, provides you a link to the admin page anyway, to see
 if you can hack into it! :)</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:server" class="def">server</a> :: <a href="Servant-OAuth2-Examples-Authorisation.html#t:Routes" title="Servant.OAuth2.Examples.Authorisation">Routes</a> (AsServerT <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a>) <a href="src/Servant.OAuth2.Examples.Authorisation.html#server" class="link">Source</a> <a href="#v:server" class="selflink">#</a></p><div class="doc"><p>The final full server; we need a special <code>hoistServer</code> for the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:site" title="Servant.OAuth2.Examples.Authorisation">site</a></code>
 route, because we need to add the 'Maybe User' into the <code><a href="Servant-OAuth2-Examples-Authorisation.html#t:Env" title="Servant.OAuth2.Examples.Authorisation">Env</a></code>. Otherwise,
 we just do as we've always done - pass off to the <code><a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#v:authServer" title="Servant.OAuth2">authServer</a></code>.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:mkGithubSettings" class="def">mkGithubSettings</a> :: Key -&gt; <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a> -&gt; <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Github <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#mkGithubSettings" class="link">Source</a> <a href="#v:mkGithubSettings" class="selflink">#</a></p><div class="doc"><p>Our usual approach for <code>Github</code> settings.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:mkGoogleSettings" class="def">mkGoogleSettings</a> :: Key -&gt; <a href="Servant-OAuth2-Examples-Config.html#t:OAuthConfig" title="Servant.OAuth2.Examples.Config">OAuthConfig</a> -&gt; <a href="../servant-oauth2-0.1.0.1/Servant-OAuth2.html#t:OAuth2Settings" title="Servant.OAuth2">OAuth2Settings</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:PageM" title="Servant.OAuth2.Examples.Authorisation">PageM</a> Google <a href="Servant-OAuth2-Examples-Authorisation.html#t:OAuth2Result" title="Servant.OAuth2.Examples.Authorisation">OAuth2Result</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#mkGoogleSettings" class="link">Source</a> <a href="#v:mkGoogleSettings" class="selflink">#</a></p><div class="doc"><p>Our usual approach for <code>Google</code> settings.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:main" class="def">main</a> :: <a href="../base-4.15.1.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Servant.OAuth2.Examples.Authorisation.html#main" class="link">Source</a> <a href="#v:main" class="selflink">#</a></p><div class="doc"><p>Our usual approach to the <code><a href="Servant-OAuth2-Examples-Authorisation.html#v:main" title="Servant.OAuth2.Examples.Authorisation">main</a></code> function; setting up the settings,
 setting up the contexts for the relevant auth handler functions.</p><p><em>Since: 0.1.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:loadDb" class="def">loadDb</a> :: <a href="../base-4.15.1.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Servant-OAuth2-Examples-Authorisation.html#t:Db" title="Servant.OAuth2.Examples.Authorisation">Db</a> <a href="src/Servant.OAuth2.Examples.Authorisation.html#loadDb" class="link">Source</a> <a href="#v:loadDb" class="selflink">#</a></p><div class="doc"><p>Utility function to load the hard-coded database.</p><p><em>Since: 0.1.0.0</em></p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.25.1</p></div></body></html>